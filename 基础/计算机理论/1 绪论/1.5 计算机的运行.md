# 1.5 计算机的运行

（review总结：启动其实就是控制权从 bios-> 主硬盘mbr-> 到硬盘分区vbr/ebr/启动管理器 一步步引导的过程）

## BIOS阶段
 【Basic Input Output System】基于ROM，开机程序刷入ROM，通电开机即读取。
* 硬件自检：POST(power-on self-test)
* 启动顺序：自检完成将**控制权转移**，根据**外部存储设备的排序**进行转接【BIOS可以设定启动顺序】
## 主引导记录阶段
* (Master Boot Record)==MBR:== 即启动顺序【排序第一】的存储设备（默认是硬盘，有可能是启动盘u盘）的第一个扇区【最前面的512字节】，the last two byte are 0x55 and 0xAA ? 可以**启动**:转交**控制权**
  * 结构：MBR只有512字节，主要引导计算机到哪个位置去操作系统
    * 1-446:调用操作系统的机器码
    * 447-510 分区表
    * 511-512 字节：==主引导记录签名==（0x55 0xAA）
  * 分区表:**硬盘**分区，假设每个分区装一个操作系统，主引导记录可以根据分区表进行区分（索引）。分区表**64字节**，最多能分4项，每项16字节即**四个1级分区**
    *  每个主分区组成
        * 第一个字节 0x80代表激活分区，**控制权转交**给这个分区。4个分区只能有一个激活
        * 2-4:主分区【在哪】的第一个扇区物理位置（哪一层柱面、上or下磁头，哪一个扇区号）
        * 5:主分区类型
        * 6-8:主分区最后一个扇区物理位置
        * 9-12:第一个扇区的逻辑地址
        * 13-16:主分区的扇区总数  = > 2的（4 byte）=2的（32bit）
    
   * ==分区大小==：【主分区扇区数目2的32】 * 【512 byte扇区大小】
   =2的41 
   =2的40*2 
   =1*1024x1024x1024x1024x2 【b kb mb gb tb】 2的10 x 2的10x2的10x2的10x2
   =**2TB**
   * ==硬盘大小==：扇区逻辑地址是32位，所以单个硬盘的可用空间也同上。

  
  
## 硬盘启动阶段
某个主分区掌握控制权阶段
* 情况A卷引导记录：
四个分区只有一个激活的，计算机读取激活分区的第一个扇区（Volume Boot Record，VBR）。操作系统就存放在这个分区位置。
* 情况B扩展分区和逻辑分区：
硬盘扩大，需要分区，但是分区表只有4项，所以==其中==只会有一个**扩展分区**的规定区域
  *  Extended BootRecord，EBR。扩展分区的第一个扇区。类似MBR硬盘的第一个扇区，作为扩展分区的引导，其中也有一个分区表64字节，其中最多只有两项目。所以只会有==两个分区==。
  * 第二个逻辑分区中类似的可以通过上述步骤，寻找逻辑分区中的第一个扇区（又称为EBR），不断地寻找得到无限个逻辑分区。直至最后一个分区只包含自身。 
  * 一般很少这么启动，一般是靠下述情况
* 情况C启动管理器
  *  读取到MBR的446字节后，不读取分区表转交控制，而是启动启动管理器（Boot Loader）。linux最流行的启动管理器是Grub
## 操作系统阶段
控制权转移给操作系统，内核首先被载入如内存。
如linux。
*  载入/boot的kernel 
* 内核载入完成，运行/sbin/init 产生init进程，pid=1
* init进程加载模块完成，如各种窗口网络程序，执行/sbin/login，等待用户输入账号密码

启动ok